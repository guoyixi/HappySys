<!DOCTYPE HTML>
<html  xmlns:th="http://www.thymeleaf.org">
<head>
	<div th:replace="~{common/_meta.html}"></div>


	<link rel="stylesheet" href="/layui/css/layui.css"  media="all">

	<!--杂项-->
	<link rel="stylesheet" href="/layui/assets/common.css"/>
	<link rel="stylesheet" href="/layui/css/aa.css">
	<style>
		/** 箭头未展开 */
		#table1 + .treeTable .treeTable-icon .layui-icon-triangle-d:before {
			content: "\e602";
		}
		/** 箭头展开 */
		#table1 + .treeTable .treeTable-icon.open .layui-icon-triangle-d:before {
			content: "\e61a";
		}
		/** 文件图标 */
		#table1 + .treeTable .treeTable-icon .layui-icon-file:before {
			content: "\e60d";
		}
		/** 文件夹未展开 */
		#table1 + .treeTable .treeTable-icon .layui-icon-layer:before {
			content: "\e637";
		}
		/** 文件夹展开 */
		#table1 + .treeTable .treeTable-icon.open .layui-icon-layer:before {
			content: "\e634";
		}
		.my_select{
			width: 200px;
			height: 30px;
			border: 1px solid gainsboro;
		}
		.my_optionsbtn{
			height: 27px;
			width: 90px;
			margin-left: 52px;
			line-height: 27px;
		}
	</style>
	<!--/杂项-->

<title>添加商品</title>
</head>
<body>
<!--_header 作为公共模版分离出去-->
<div th:replace="~{common/_header::#box_header}"></div>
<!--/_header 作为公共模版分离出去-->

<!--_menu 作为公共模版分离出去-->
<div th:replace="~{common/_menu::#box_menu}"></div>
<!--/_menu 作为公共模版分离出去-->


<section class="Hui-article-box">
	<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 产品管理 <span class="c-gray en">&gt;</span> 品牌管理 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a></nav>

	<div class="Hui-article">
		<article style="margin-left: -100px" class="cl pd-20">
			<form action="/product/add" method="post" class="form form-horizontal"  enctype="multipart/form-data" ><!--id="form-member-add"-->
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>产品名：</label>
					<div class="formControls col-xs-8 col-sm-9" style="width: 600px;">
						<input type="text" class="input-text" value="" placeholder="" id="productname" name="productTitle">
					</div>
				</div>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>价格：</label>
					<div class="formControls col-xs-8 col-sm-9" style="width: 400px;">
						<input type="text" width="300px" class="input-text" value="" placeholder="" id="price" name="productPrice">
					</div>
				</div>

				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3" ><span class="c-red">*</span>附件图片：</label>
					<div class="formControls col-xs-8 col-sm-9"> <span class="btn-upload form-group">
					<input class="input-text upload-url" type="text" name="file" id="uploadfile" readonly nullmsg="请添加附件！" style="width:200px">
					<a href="javascript:void();" class="btn btn-primary radius upload-btn" style="margin-left: 50px;">
						<i class="Hui-iconfont">&#xe642;</i> 浏览文件</a>
					<input type="file" multiple name="file2" class="input-file">
					</span>
					</div>
				</div>

				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>年龄期间：</label>
					<div class="formControls col-xs-8 col-sm-9">
						<!--<div id="section" class="demo-tree demo-tree-box"></div>-->
						<a id="section" class="layui-btn layui-btn-primary layer-demolist my_optionsbtn" style="height: 27px;line-height: 27px" onclick="productOptionsOperations(1)" href="javascript:void(0);">添加</a>
					</div>
				</div>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>保险期限：</label>
					<div class="formControls col-xs-8 col-sm-9">
						<!--<div id="deadline" class="demo-tree demo-tree-box"></div>-->
						<a id="deadline" class="layui-btn layui-btn-primary layer-demolist my_optionsbtn" style="height: 27px;line-height: 27px" onclick="productOptionsOperations(2)" href="javascript:void(0);">添加</a>
					</div>
				</div>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>保险保额：</label>
					<div class="formControls col-xs-8 col-sm-9">
				<!--	<div id="insuranceSum" class="demo-tree demo-tree-box"></div>-->
						<a id="insuranceSum" class="layui-btn layui-btn-primary layer-demolist my_optionsbtn" style="height: 27px;line-height: 27px" onclick="productOptionsOperations(3)" href="javascript:void(0);">添加</a>
					</div>
				</div>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>保险特色：</label>
					<div class="formControls col-xs-8 col-sm-9">
						<!--<div id="feature" class="demo-tree demo-tree-box"></div>-->
						<a id="feature" class="layui-btn layui-btn-primary layer-demolist my_optionsbtn" style="height: 27px;line-height: 27px" onclick="productOptionsOperations(4)" href="javascript:void(0);">添加</a>
					</div>
				</div>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>保险：</label>
					<div class="formControls col-xs-8 col-sm-9">
						<!--<div id="insurance" class="demo-tree demo-tree-box"></div>-->
						<a id="insurance" class="layui-btn layui-btn-primary layer-demolist my_optionsbtn" style="height: 27px;line-height: 27px" onclick="productOptionsOperations(5)" href="javascript:void(0);">添加</a>
					</div>
				</div>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>分类：</label>
					<div class="formControls col-xs-8 col-sm-9">
						<span id="biaoji"></span>
						<select id="product_level2" class="my_select" name="productLevel2">
							<option value="-1">--请选择--</option>
						</select>
						<select id="product_level3" class="my_select" name="productLevel3">
							<option value="-1">--请选择--</option>
						</select>
					</div>
				</div>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>描述：</label>
					<div class="formControls col-xs-8 col-sm-9">
						<textarea name="productDetails" style="width: 600px" cols="" rows="" class="textarea"  placeholder="说点什么...最少输入5个字符" ></textarea>
						<!--<p class="textarea-numberbar"><em class="textarea-length">0</em>/100</p>-->
					</div>
				</div>
				<div class="row cl">
					<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
						<input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;提交&nbsp;&nbsp;">
					</div>
				</div>
			</form>

		</article>
	</div>
</section>


<!--_footer 作为公共模版分离出去-->
<div th:replace="~{common/_footer::#box_footer}"></div>

<!--/_footer /作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="/lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="/lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="/lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="/lib/jquery.validation/1.14.0/messages_zh.js"></script>
<script src="/layui/layui.js" charset="utf-8"></script>

<script type="text/javascript" th:inline="javascript">

	function validating() {
		var form = $("#aa");
		for (var i = 0; i < form.length; i++) {
			var text = $(form[i]).find("input[type='text']");
			text.each(function (i, dom) {
				var d = $(dom).val();
				if (!d) {
					alert("请将信息填写完整！");
					//flag = false;
					return false;
				}
			})
		}
	}

	var sectionJson ;
	var dealineJson ;
	var insuranceSumJson ;
	var featureJson ;
	var insuranceJson ;
	
	function productOptionsOperations(loadType){
		layer.open({
			type: 1,
			area: ['600px', '500px'],
			fixed: false, //不固定
			maxmin: true,
			title: "添加信息",
			content: $("#product_options_operations_panel").show().html(),
			success: function (a,index) {
				var trs = "";
				var $optionsPanelTable = $("#optionsPanelTable");
				if(loadType == 1){//年龄
					trs = '<tr><td>最小年龄</td><td>最大年龄</td><td>价格</td></tr>';
					$(sectionJson.children).each(function(index,obj){
						trs += '<tr><td>'+obj.sectionMin+'</td>'
								+'<td>'+obj.sectionMax+'</td>'
								+'<td>'+obj.sectionPrice+'</td></tr>';
					});

				}else if(loadType == 2){//期限
					trs ='<tr><td>保险期限</td><td>单位</td><td>价格</td></tr>';
					$(dealineJson.children).each(function(index,obj){
						trs += '<tr><td>'+obj.deadlineDays+'</td>'
						+'<td>'+(obj.deadlinePrice > 365 ? obj.deadlinePrice / 365:obj.deadlinePrice)+'</td>'
						+'<td>'+(obj.deadlinePrice > 365 ? '年':'天')+'</td></tr>';
					});

				}else if(loadType == 3){//保额
					trs ='<tr><td>保额</td><td>价格</td></tr>';
					$(insuranceSumJson.children).each(function(index,obj){
						trs += '<tr>'+obj.insuranceSum+'<td></td>'
						+'<td>'+obj.insuranceSumPrice+'</td></tr>';
					});

				}else if(loadType == 4){//特色
					trs ='<tr><td>特色标题</td><td>所属商品分类</td></tr>';
					$(featureJson.children).each(function(index,obj){
						trs += '<tr><td>'+obj.featureName+'</td>'
						+'<td>'+obj.featureCategoryTitle+'</td></tr>';
					});

				}else if(loadType == 5){//保险项
					trs ='<td>保险名</td><td>保额</td><td>价格</td><td>描述</td>';

					$(insuranceJson.children).each(function(index,obj){
						trs += '<tr>'+obj.insuranceName+'<td></td>'
						+'<td>'+obj.insuranceCompensatePrice+'</td></tr>'
						+'<td>'+obj.insurancePrice+'</td></tr>'
						+'<td>'+obj.insuranceDetails+'</td></tr>'
					});

				}
				$optionsPanelTable.empty();
				$optionsPanelTable.append(trs);
			}
		});
	}

	$(document).on("change","#product_level1",function () {
		var parentid=$(this).val();
		$("#product_level2").find("option").remove();
		$.post("/ajax/category/"+parentid,function (data) {
		    var str="";
            for (var i=0;i<data.length;i++){
                str+="<option name=\"productLevel2\" value=\""+data[i].categoryId+"\">"+data[i].categoryName+"</option>";
            }
            $("#product_level2").append(str);
        })
    });

    $(document).on("change","#product_level2",function () {
        var parentid=$(this).val();
        $("#product_level3").find("option").remove();
        $.post("/ajax/category/"+parentid,function (data) {
            var str="";
            for (var i=0;i<data.length;i++){
                str+="<option name=\"productLevel3\" value=\""+data[i].categoryId+"\">"+data[i].categoryName+"</option>";
            }
            $("#product_level3").append(str);
        })
    });

    
$(function() {

    $.post("/ajax/section", function (data) {
		sectionJson = data;
		console.info(data);
        /*layui.use(['tree', 'util'], function () {
            var tree = layui.tree
                , layer = layui.layer
                , util = layui.util

                //section渲染数据
                , data2 = data

            //常规用法
            tree.render({
                elem: '#section' //默认是点击节点可进行收缩
                , data: data2
            });
        })*/
        //$("#ageselect").remove();
		var str="<select id='ageselect' class='my_select' name='productSectionList'>"
				+"<option value=''>--请选择--</option>";

		for(var i=0;i<data.length;i++){
			str+="<option value=\""+data[i].id+"\">"+data[i].title+"</option>";
		}
		str+="</select>";
		$("#section").before(str);
    });

    $.post("/ajax/dealinelist",function (data) {
		dealineJson = data;
		console.info(data);
        /*layui.use(['tree', 'util'], function () {
            var tree = layui.tree
                , layer = layui.layer
                , util = layui.util

                //section渲染数据
                , data2 = data

            //常规用法
            tree.render({
                elem: '#deadline' //默认是点击节点可进行收缩
                , data: data2
            });
        })*/
        //$("#deadlineselect").remove();
        var str="<select id='deadlineselect' class='my_select' name='productDeadlineList'>"
				+"<option value=''>--请选择--</option>";
        for(var i=0;i<data.length;i++){
            str+="<option value=\""+data[i].id+"\">"+data[i].title+"</option>";
        }
        str+="</select>";
        $("#deadline").before(str);
    });

	$.post("/ajax/insuranceSumList",function (data) {
		insuranceSumJson = data;
		console.info(data);
        /*layui.use(['tree', 'util'], function () {
            var tree = layui.tree
                , layer = layui.layer
                , util = layui.util

                //section渲染数据
                , data2 = data

            //常规用法
            tree.render({
                elem: '#insuranceSum' //默认是点击节点可进行收缩
                , data: data2
            });
        })*/
        //$("#deadlineselect").remove();
        var str="<select id='insuranceSumselect' class='my_select' name='productInsuranceSumList'>"
				+"<option value=''>--请选择--</option>";
        for(var i=0;i<data.length;i++){
            str+="<option value=\""+data[i].id+"\">"+data[i].title+"</option>";
        }
        str+="</select>";
        $("#insuranceSum").before(str);
    });

	$.post("/ajax/featureList",function (data) {
		featureJson = data;
		console.info(data);
        /*layui.use(['tree', 'util'], function () {
            var tree = layui.tree
                , layer = layui.layer
                , util = layui.util

                //section渲染数据
                , data2 = data

            //常规用法
            tree.render({
                elem: '#feature' //默认是点击节点可进行收缩
                , data: data2
            });
        })*/
        //$("#featureselect").remove();
        var str="<select id='featureselect' class='my_select' name='productFeatureList'>"
				+"<option value=''>--请选择--</option>";
        for(var i=0;i<data.length;i++){
            str+="<option value=\""+data[i].id+"\">"+data[i].title+"</option>";
        }
        str+="</select>";
        $("#feature").before(str);
    });

	$.post("/ajax/insurance_list",function (data) {
		insuranceJson = data;
		console.info(data);
        /*layui.use(['tree', 'util'], function () {
            var tree = layui.tree
                , layer = layui.layer
                , util = layui.util

                //section渲染数据
                , data2 = data

            //常规用法
            tree.render({
                elem: '#insurance' //默认是点击节点可进行收缩
                , data: data2
            });
        })*/
        //$("#insuranceselect").remove();
        var str="<select id='insuranceselect' class='my_select' name='productInsuranceList'>"
				+"<option value=''>--请选择--</option>";
        for(var i=0;i<data.length;i++){
            str+="<option value=\""+data[i].id+"\">"+data[i].title+"</option>";
        }
        str+="</select>";
        $("#insurance").before(str);
    });


	$.post("/ajax/category/0",function (data) {
		var str="<select id='product_level1' class='my_select' name='productLevel1'><option name=\"yiji\" value='-1'>--请选择--</option>";
		for (var i=0;i<data.length;i++){
		    str+="<option value=\""+data[i].categoryId+"\">"+data[i].categoryName+"</option>";
		}
		str+="</select>";
		$("#biaoji").before(str);
    });

	$('.skin-minimal input').iCheck({
		checkboxClass: 'icheckbox-blue',
		radioClass: 'iradio-blue',
		increaseArea: '20%'
	});

	$("#form-member-add").validate({
		rules: {
			username: {
				required: true,
				minlength: 2,
				maxlength: 16
			},
			sex: {
				required: true,
			},
			mobile: {
				required: true,
				isMobile: true,
			},
			email: {
				required: true,
				email: true,
			},
			uploadfile: {
				required: true,
			},

		},
		onkeyup: false,
		focusCleanup: true,
		success: "valid",
		submitHandler: function (form) {
			$(form).ajaxSubmit();
			var index = parent.layer.getFrameIndex(window.name);
			parent.$('.btn-refresh').click();
			parent.layer.close(index);
		}
	});

	layer.msg('加载中', {
		icon: 16
		,shade: 0.01
		,area: ['200px', '65px']
	});
});

</script>
</body>

<div class="layuimini-container" id="product_options_operations_panel" align="center" style="display: none;">
	<div class="layuimini-main">
		<fieldset class="layui-elem-field layuimini-search">
			<div style="margin: 10px 10px 10px 10px">
				<form class="layui-form layui-form-pane" action="">
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">父类名字</label>
							<div class="layui-input-inline">
								<input type="text" name="goodsname" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<a class="layui-btn" lay-submit="" lay-filter="data-search-btn">搜索</a>
						</div>
						<div class="layui-inline" style="margin-left: 10px">
							<a class="layui-btn" lay-submit="" lay-filter="data-create-btn">+新增父类</a>
						</div>
					</div>
					<table id="optionsPanelTable" class="layui-table" 	lay-filter="table1">
						<!--年龄项-->
						<!--<tr>
							<td>最小年龄</td>
							<td>最大年龄</td>
							<td>价格</td>
						</tr>
						<tr>
							<td>asssss</td>
							<td>saaaaaaaaaaaa</td>
							<td>安定</td>
						</tr>-->

						<!--期限项-->
						<!--<tr>
							<td>保险期限</td>
							<td>单位</td>
							<td>价格</td>
						</tr>
						<tr>
							<td>asssss</td>
							<td>下拉框！！（天，年）</td>
							<td>安定</td>
						</tr>-->

						<!--保额项-->
						<!--<tr>
							<td>保额</td>
							<td>价格</td>
						</tr>
						<tr>
							<td></td>
							<td></td>
						</tr>-->

						<!--特色项-->
						<!--<tr>
							<td>特色标题</td>
							<td>所属商品分类</td>
						</tr>
						<tr>
							<td>hanbyan</td>
							<td>安定</td>
						</tr>-->

						<!--保险项-->
						<!--<tr>
							<td>保险名</td>
							<td>保额</td>
							<td>价格</td>
							<td>描述</td>
						</tr>
						<tr>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>-->
					</table>
				</form>
				<table class="layui-hide" id="test" lay-filter="test"></table>
			</div>
		</fieldset>
	</div>
</div>


</html>